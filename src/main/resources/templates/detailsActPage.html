<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: head"></head>
<body>
	<script type="text/javascript">
		$(document).ready(function() {
			Amel.details_init();
		});
	</script>
	<div th:replace="fragments/header :: header"></div>
	<div class="container">
		<form action="detailsObj" method="POST" enctype="multipart/form-data" class="form" role="form" autocomplete="off">
			<div th:replace="fragments/header :: details-param"></div>
    		<div th:replace="fragments/header :: details-header"></div>
           	<div th:with="st=${obj.act_status==null ? '1' : obj.act_status?.code},adm=${#strings.contains(p_roles,'ADMIN') ? 1 : 0},rco=${adm==1 || st=='1' ? 0 : 1}" class="col-sm-12 card small">
            	<div class="m-sm-2">
            		<div th:replace="fragments/header :: details-buttons"></div>
	                <div class="col-sm-12 border fit-height">
	                	<div class="w-100 border border-primary">
	                		<table class="table table-sm table-edited table-bordered small"><tbody><tr>
		                		<th:block th:with="w='13%',tt='label',vv='Дата создания'"><th th:replace="fragments/tc :: ch"></th></th:block>
		                		<th:block th:with="w='20%',tt='time',vv=${obj.create_time},ro=1"><td th:replace="fragments/tc :: cd"></td></th:block>
		                		<th:block th:with="w='13%',tt='label',vv='Создан пользователем'"><th th:replace="fragments/tc :: ch"></th></th:block>
		          				<th:block th:with="w='20%',tt='text',vv=${obj.create_agent?.name},ro=1"><td th:replace="fragments/tc :: cd"></td></th:block>
			                    <td width="34%"></td>
			                </tr></tbody></table>
		                	<table class="table table-sm table-edited table-bordered small"><tbody><tr>
		                		<th:block th:with="w='13%',tt='label',vv='№ акта',rr=1"><th th:replace="fragments/tc :: ch"></th></th:block>
		          				<th:block th:with="w='20%',tt='text',nn='act_number',vv=${obj.act_number},ro=${rco},rr=1"><td th:replace="fragments/tc :: cd"></td></th:block>
		          				<th:block th:with="w='13%',tt='label',vv='Дата акта',rr=1"><th th:replace="fragments/tc :: ch"></th></th:block>
		          				<th:block th:with="w='20%',tt='date',nn='act_date',vv=${obj.act_date},ro=${rco},rr=1"><td th:replace="fragments/tc :: cd"></td></th:block> 
			                    <td width="1%"></td>
			                </tr></tbody></table>
	                    	<table class="table table-sm table-edited table-bordered small parent-popup"><tbody><tr>
		                    	<th:block th:with="w='33%',tt='label',vv='Структурное подразделение',rr=1"><th th:replace="fragments/tc :: ch"></th></th:block>
		                    	<th:block th:with="w='4%',tt='text',vv=${obj.depart?.code},ro=1"><td th:replace="fragments/tc :: cd"></td></th:block>
		                    	<th:block th:with="w='59%',tt='text',vv=${obj.depart?.name},ro=1"><td th:replace="fragments/tc :: cd"></td></th:block>
								<th:block th:with="w='4%',tt='pbutton',nn1='depart',nn2='',vv=${obj.depart?.rn},ro=${rco},ddcl='IDepartment',ddti='Выберите подразделение',ddco='rn;code=Код=YYA;name=Наименование',ddfi=''"><td th:replace="fragments/tc :: cd"></td></th:block>                    	
		                    </tr></tbody></table>
	                    </div>
                       	<div class="w-100 border border-primary">
 							<table class="table table-sm table-edited table-bordered small"><tbody><tr>
					        	<th:block th:with="w='16%',tt='label',vv='Документы, включенные в акт'"><th th:replace="fragments/tc :: ch"></th></th:block>
					        	<th:block th:with="w='16%',tt='xbutton',vv='Добавить',ddco='add',ddta='list_doc'"><td th:replace="fragments/tc :: cd"></td></th:block>
					        	<th:block th:with="w='16%',tt='xbutton',vv='Удалить',ddco='remove',ddta='list_doc'"><td th:replace="fragments/tc :: cd"></td></th:block>
					        	<td width="52%"></td>
					        </tr></tbody></table>
					        <table id="list_doc" class="table table-sm table-edited table-bordered small">
					        	<tbody>
					        		<tr>
							       		<td class="d-none"></td>
							       		<th:block th:with="w='5%',tt='label',vv=''"><td th:replace="fragments/tc :: cd"></td></th:block>
							       		<th:block th:with="w='24%',tt='label',vv='Документ',cs=2"><td th:replace="fragments/tc :: cd"></td></th:block>
							       		<th:block th:with="w='20%',tt='label',vv='Исключен из акта'"><td th:replace="fragments/tc :: cd"></td></th:block>
							       		<th:block th:with="w='20%',tt='label',vv='Дата исключения'"><td th:replace="fragments/tc :: cd"></td></th:block>
							       		<th:block th:with="w='20%',tt='label',vv='Причина'"><td th:replace="fragments/tc :: cd"></td></th:block>
							      		<td width="11%"></td>
					       			</tr>
					     		</tbody>
					        	<tbody>
						        	<tr th:each="d : ${obj?.list_doc}" class="parent-popup">
							         	<td class="d-none">
							         		<input type="hidden" name="list_doc__rn" th:value="${d.rn}">
							            	<input type="hidden" name="list_doc__rnOld" th:value="${d.rn}">
							            	<input type="hidden" name="list_doc__clazz" value="Act_document">
							            	<input type="hidden" name="list_doc__p_add" value="new">
							            	<input type="hidden" name="list_doce__p_cmd" value="">	
							           	</td>
							           	<th:block th:with="w='5%',tt='check',vv='',cc='td-check'"><td th:replace="fragments/tc :: check"></td></th:block>
							           	<th:block th:with="w='20%',tt='text',vv=${d.doc?.name},ro=1"><td th:replace="fragments/tc :: cd"></td></th:block>
	            						<th:block th:with="w='4%',tt='pbutton',nn1='list_doc',nn2='doc',vv=${d.doc?.rn},ro=${rco},ddcl='Document',ddti='Выберите документ',ddco='rn;name=Документ=YYA',ddfi='doc_status__code =''2'';depart__rn =#d#'"><td th:replace="fragments/tc :: cd"></td></th:block>
	            						<th:block th:with="w='20%',tt='check',nn='list_doc__exclude',vv=${d.exclude},ro=${adm!=1 && st!='3'}"><td th:replace="fragments/tc :: cd"></td></th:block>
							           	<th:block th:with="w='20%',tt='date',nn='list_doc__exclude_date',vv=${d.exclude_date},ro=1"><td th:replace="fragments/tc :: cd"></td></th:block>
							           	<th:block th:with="w='20%',tt='text',nn='list_doc__exclude_reason',vv=${d.exclude_reason},ro=${adm!=1 && st!='3'}"><td th:replace="fragments/tc :: cd"></td></th:block>
							           	<td width="11%"></td>
							       	</tr>
							       	<tr th:if="${rco!=1}" class="not-visible last-row">
							           	<td class="d-none">
							           		<input type="hidden" name="list_doc__rn" value="">
							            	<input type="hidden" name="list_doc__rnOld" value="">
							            	<input type="hidden" name="list_doc__clazz" value="IFile">
							            	<input type="hidden" name="list_doc__p_add" value="new">
							            	<input type="hidden" name="list_doc__p_cmd" value="">
							           	</td>
							           	<th:block th:with="w='5%',tt='check',vv='',cc='td-check'"><td th:replace="fragments/tc :: check"></td></th:block>
							           	<th:block th:with="w='20%',tt='text',vv='',ro=1"><td th:replace="fragments/tc :: cd"></td></th:block>
	            						<th:block th:with="w='4%',tt='pbutton',nn1='list_doc',nn2='doc',vv='',ro=${rco},ddcl='Document',ddti='Выберите документ',ddco='rn;name=Документ=YYA',ddfi='doc_status__code =''2'';depart__rn =#d#'"><td th:replace="fragments/tc :: cd"></td></th:block>
	            						<th:block th:with="w='20%',tt='check',nn='list_doc__exclude',vv=''"><td th:replace="fragments/tc :: cd"></td></th:block>
							           	<th:block th:with="w='20%',tt='date',nn='list_doc__exclude_date',vv='',ro=1"><td th:replace="fragments/tc :: cd"></td></th:block>
							           	<th:block th:with="w='20%',tt='text',nn='list_doc__exclude_reason',vv=''"><td th:replace="fragments/tc :: cd"></td></th:block>
							           	<td width="11%"></td>
							    	</tr>
					        	</tbody>
				        	</table>                       	
                       	</div>
						<div class="w-100 border border-primary">
							<table class="table table-sm table-edited table-bordered small"><tbody><tr>
		                   		<th:block th:with="w='7%',tt='label',vv='Статус'"><th th:replace="fragments/tc :: ch"></th></th:block>
		                		<th:block th:with="w='13%',tt='select',nn='act_status',ll=${listDocStatus},vv=${obj.doc_status},ro=${rco}"><td th:replace="fragments/tc :: cd"></td></th:block> 	
	                    		<th:block th:with="w='20%',tt='label',vv='Дата присвоения статуса'"><th th:replace="fragments/tc :: ch"></th></th:block>
	                    		<th:block th:with="w='13%',tt='time',vv=${obj.time_status},ro=1"><td th:replace="fragments/tc :: cd"></td></th:block>
	                    		<th:block th:with="w='13%',tt='label',vv='Причина отказа'"><th th:replace="fragments/tc :: ch"></th></th:block>
	                    		<th:block th:with="w='20%',tt='text',nn='act_reason',vv=${obj.act_reason},ro=${adm==1 || st=='6' ? 0 : 1}"><td th:replace="fragments/tc :: cd"></td></th:block>
	                    		<td width="14%"></td>
	                    	</tr></tbody></table>
							<table class="table table-sm table-edited table-bordered small"><tbody><tr>
		                   		<th:block th:with="w='13%',tt='label',vv='Дата изменения'"><th th:replace="fragments/tc :: ch"></th></th:block>
		                		<th:block th:with="w='20%',tt='time',vv=${obj.change_time},ro=1"><td th:replace="fragments/tc :: cd"></td></th:block> 	
	                    		<th:block th:with="w='13%',tt='label',vv='Изменен пользователем'"><th th:replace="fragments/tc :: ch"></th></th:block>
	                    		<th:block th:with="w='20%',tt='text',vv=${obj.change_agent?.name},ro=1"><td th:replace="fragments/tc :: cd"></td></th:block>
	                    		<td width="34%"></td>
	                    	</tr></tbody></table>
						</div>
	                    <div class="w-100 border border-primary">
	                    	<th:block th:replace="fragments/header :: file_list"/>
	                    </div>
                    </div>
				</div>
			</div>
		</form>
	</div>
	<div th:replace="fragments/header :: details-footer"></div>
</body>
</html>